import{h as e,k as t,G as a,Q as s,l,o as r,c as o,w as n,m as i,i as c,d as u,p as d,t as g,b as p,e as m,r as f,F as h,n as v,R as w,K as y,x as _,z as x,J as $,T as b}from"./index-CoyfKnWG.js";import{_ as k}from"./uni-icons.D0E4Jxnq.js";import{o as j,d as F,e as z,r as S}from"./uni-app.es.Df7zo4VE.js";import{_ as I}from"./uv-loading-icon.CbeM7PMZ.js";import{g as C}from"./home.CWEEYXWH.js";import{_ as M}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./mixin.BCR4gqL3.js";import"./request.BIpDWIEA.js";const A=M({__name:"details",setup(M){const A=e({title:"",content:"",coverImage:"",summary:"",author:"",category:"",tags:[]}),U=e(!0),T=e(!1);e(!1),e(!1);const D=e(0),E=e(0),q=e([]),H=t((()=>{if(!A.value.content)return"";let e=A.value.content;return e=e.replace(/<img/g,'<img style="max-width:100%;height:auto;border-radius:12rpx;margin:20rpx 0;"'),e=e.replace(/<p/g,'<p style="margin-bottom:30rpx;line-height:1.8;color:#333;font-size:30rpx;"'),e=e.replace(/<h1/g,'<h1 style="font-size:40rpx;margin:30rpx 0;font-weight:bold;color:#222;"'),e=e.replace(/<h2/g,'<h2 style="font-size:36rpx;margin:28rpx 0;font-weight:bold;color:#222;"'),e=e.replace(/<h3/g,'<h3 style="font-size:34rpx;margin:26rpx 0;font-weight:bold;color:#222;"'),e=e.replace(/<ul/g,'<ul style="padding-left:40rpx;margin-bottom:30rpx;"'),e=e.replace(/<li/g,'<li style="margin-bottom:16rpx;line-height:1.6;color:#333;font-size:30rpx;"'),e})),G=async e=>{try{U.value=!0;const t={id:Number(e)},s=await C(t);if(0===s.code&&s.data){const e=i(),t="zh-Hans"===e?"Zh":e.charAt(0).toUpperCase()+e.slice(1),a=`title${t}`,l=`content${t}`;A.value={title:s.data[a]||"",content:s.data[l]||"",coverImage:s.data.coverUrl||"",createdAt:Y(s.data.createdAt),time:Z(s.data.createdAt),summary:s.data[`summary${t}`]||"",author:s.data.author||"",category:s.data.category||"",tags:s.data.tags||[]},D.value=Math.floor(100*Math.random())+5,E.value=Math.floor(20*Math.random()),J(),setTimeout((()=>{U.value=!1}),300)}else U.value=!1,a({title:$t("news.loadFailed"),icon:"error"})}catch(t){console.error("Error fetching news:",t),U.value=!1,a({title:$t("news.networkError"),icon:"error"})}},J=()=>{q.value=[{id:1,title:"相关新闻标题1",coverUrl:"/static/news-placeholder.jpg"},{id:2,title:"相关新闻标题2",coverUrl:"/static/news-placeholder.jpg"},{id:3,title:"相关新闻标题3",coverUrl:"/static/news-placeholder.jpg"}]},K=()=>{const e=s(),t=e[e.length-1].options||{};t.id?G(t.id):a({title:$t("news.missingId"),icon:"none"})},N=()=>{w()},Q=e=>{const t=e.detail.scrollTop;T.value=t>300},R=()=>{y({scrollTop:0,duration:300})};function Y(e){const t=new Date(e);return`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,"0")}-${String(t.getDate()).padStart(2,"0")}`}function Z(e){const t=new Date(e);return`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`}return j((e=>{e&&e.id?G(e.id):(U.value=!1,a({title:$t("news.missingId"),icon:"none"}))})),F((()=>({title:A.value.title,path:`/pages/news/components/details?id=${s()[s().length-1].options.id}`}))),z((()=>({title:A.value.title,query:`id=${s()[s().length-1].options.id}`}))),(e,t)=>{const a=S(l("uni-icons"),k),s=c,i=S(l("uv-loading-icon"),I),w=_,y=x,j=$,F=b;return r(),o(s,{class:"news-detail-container"},{default:n((()=>[u(s,{class:"nav-bar"},{default:n((()=>[u(s,{class:"nav-bar-left",onClick:N},{default:n((()=>[u(a,{type:"arrow-left",size:"24",color:"#333"})])),_:1}),u(s,{class:"nav-bar-title"},{default:n((()=>[d(g(e.$t("news.detail")),1)])),_:1}),u(s,{class:"nav-bar-right"})])),_:1}),U.value?(r(),o(s,{key:0,class:"loading-container"},{default:n((()=>[u(i,{show:!0,mode:"spinner",text:e.$t("home.loading"),"text-color":"#8C6E63","text-size":"28rpx"},null,8,["text"])])),_:1})):A.value.content?(r(),o(s,{key:2,class:"news-content-scroll",onScroll:Q},{default:n((()=>[A.value.coverImage?(r(),o(w,{key:0,class:"news-hero-image",src:A.value.coverImage,mode:"aspectFill"},null,8,["src"])):p("",!0),u(s,{class:"news-main-content"},{default:n((()=>[u(s,{class:"news-header"},{default:n((()=>[A.value.category?(r(),o(s,{key:0,class:"news-category"},{default:n((()=>[d(g(A.value.category),1)])),_:1})):p("",!0),u(s,{class:"news-title"},{default:n((()=>[d(g(A.value.title),1)])),_:1}),u(s,{class:"news-meta"},{default:n((()=>[A.value.author?(r(),o(s,{key:0,class:"news-author"},{default:n((()=>[u(w,{class:"author-avatar",src:"/static/default-avatar.png"}),u(y,null,{default:n((()=>[d(g(A.value.author),1)])),_:1})])),_:1})):p("",!0),u(s,{class:"news-datetime"},{default:n((()=>[u(y,null,{default:n((()=>[d(g(A.value.createdAt),1)])),_:1}),u(y,{class:"time-dot"},{default:n((()=>[d("•")])),_:1}),u(y,null,{default:n((()=>[d(g(A.value.time),1)])),_:1})])),_:1})])),_:1})])),_:1}),A.value.summary?(r(),o(s,{key:0,class:"news-summary"},{default:n((()=>[u(y,null,{default:n((()=>[d(g(A.value.summary),1)])),_:1})])),_:1})):p("",!0),u(s,{class:"news-content"},{default:n((()=>[u(F,{nodes:H.value},null,8,["nodes"])])),_:1}),A.value.tags&&A.value.tags.length?(r(),o(s,{key:1,class:"news-tags"},{default:n((()=>[u(y,{class:"tag-title"},{default:n((()=>[d(g(e.$t("news.tags"))+":",1)])),_:1}),u(s,{class:"tags-list"},{default:n((()=>[(r(!0),m(h,null,f(A.value.tags,((e,t)=>(r(),o(y,{key:t,class:"tag-item"},{default:n((()=>[d("#"+g(e),1)])),_:2},1024)))),128))])),_:1})])),_:1})):p("",!0)])),_:1})])),_:1})):(r(),o(s,{key:1,class:"empty-container"},{default:n((()=>[u(w,{class:"empty-image",src:"/static/empty-content.png",mode:"aspectFit"}),u(y,{class:"empty-text"},{default:n((()=>[d(g(e.$t("news.noContent")),1)])),_:1}),u(j,{class:"refresh-btn",onClick:K},{default:n((()=>[d(g(e.$t("news.refresh")),1)])),_:1})])),_:1})),u(s,{class:v(["back-to-top",{visible:T.value}]),onClick:R},{default:n((()=>[u(a,{type:"top",size:"20",color:"#FFFFFF"})])),_:1},8,["class"])])),_:1})}}},[["__scopeId","data-v-f779615c"]]);export{A as default};
